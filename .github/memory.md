# –í–Ω–µ—à–Ω—è—è –ø–∞–º—è—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ LSwitch

**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 10 —Ñ–µ–≤—Ä–∞–ª—è 2026

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ –≤ —Å–µ—Å—Å–∏–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:

1. **–£–¥–∞–ª–µ–Ω—ã —Ñ–∞–π–ª—ã-–º—É—Å–æ—Ä:**
   - ‚ùå `core.py.broken` - —Å—Ç–∞—Ä–∞—è broken –≤–µ—Ä—Å–∏—è core
   - ‚ùå `lswitch.py` - –≤—Ä–µ–º–µ–Ω–Ω—ã–π —à–∏–º (CRITICAL —É–¥–∞–ª–µ–Ω–∏–µ)
   - ‚ùå `archive/` - –æ—á–∏—â–µ–Ω–∞ –æ—Ç –≤—Å–µ–≥–æ –Ω–µ–Ω—É–∂–Ω–æ–≥–æ

2. **–ö–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
   - `config.py` —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ + –∫–ª–∞—Å—Å `ConfigManager`
   - –£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏–∫–∞—Ç `managers/config_manager.py`
   - –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ re-export –≤ `managers/__init__.py`
   - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ `docs/CONFIG_ARCHITECTURE.md`

3. **–ù–∞—á–∞—Ç–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞:**
   - `lswitch/utils/` - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ (desktop, theme, keyboard, buffer)
   - `lswitch/cli.py` - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
   - `lswitch/config.py` - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
   - –°–æ–∑–¥–∞–Ω –º–∞—Ä–∫–µ—Ä `py.typed` –¥–ª—è py-aware –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

4. **–û—á–∏—â–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Ñ–∞–π–ª—ã –ø—Ä–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞ `docs/historical/` –¥–ª—è –∞—Ä—Ö–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –ù–æ–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `CONFIG_ARCHITECTURE.md`

## –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞

### üî¥ HIGH PRIORITY (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ):

1. **–î–æ–±–∞–≤–∏—Ç—å type hints –≤ core.py (1692 —Å—Ç—Ä–æ–∫)**
   - –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å `LSwitch`
   - –°–ª–æ–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
   - –ú–µ—Ç–æ–¥—ã, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–µ dict/list/tuple
   - –≠—Å—Ç–∏–º–∞—Ç: 3-5 –¥–Ω–µ–π —Ä–∞–±–æ—Ç—ã

2. **–î–æ–±–∞–≤–∏—Ç—å type hints –≤ adapters/**
   - `x11.py` - —Ä–∞—Å—à–∏—Ä–∏—Ç—å (—Å–µ–π—á–∞—Å 26%)
   - `kde.py`, `cinnamon.py`, `base.py` - –¥–æ–±–∞–≤–∏—Ç—å
   - –≠—Å—Ç–∏–º–∞—Ç: 1-2 –¥–Ω—è

3. **–ö–ª–∞—Å—Å—ã —Å type hints:**
   - `processors/`, `handlers/`, `managers/`
   - –≠—Å—Ç–∏–º–∞—Ç: 1-2 –¥–Ω—è

### üü† MEDIUM PRIORITY (—É–ª—É—á—à–∏—Ç—å):

4. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Ç–µ—Å—Ç–æ–≤ (45+ —Ñ–∞–π–ª–æ–≤)**
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å: `tests/unit/`, `tests/integration/`, `tests/e2e/`
   - –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (–∏—Å–ø–æ–ª—å–∑—É—è parametrize)
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å fixtures (–ª–µ–Ω–∏–≤—ã–µ —Å–æ–∑–¥–∞–Ω–∏—è)
   - –≠—Å—Ç–∏–º–∞—Ç: 3-4 –¥–Ω—è

5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π API**
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –°–æ–∑–¥–∞—Ç—å `docs/API.md`
   - –≠—Å—Ç–∏–º–∞—Ç: 1 –¥–µ–Ω—å

6. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**
   - –°—Ü–µ–Ω–∞—Ä–∏–π: capture ‚Üí convert ‚Üí paste
   - –°—Ü–µ–Ω–∞—Ä–∏–π: selection mode
   - –°—Ü–µ–Ω–∞—Ä–∏–π: mode switching
   - –≠—Å—Ç–∏–º–∞—Ç: 1-2 –¥–Ω—è

### üü¢ LOW PRIORITY (nice to have):

7. **Wayland –ø–æ–¥–¥–µ—Ä–∂–∫–∞** -–æ—Å–º–æ—Ç—Ä –∏–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è –∫–æ–¥–∞
8. **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏** –¥–ª—è type hints
9. **Pre-commit hooks** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤
10. **GitHub Actions CI** —Å type checking

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –≤ —Ç–µ—Å—Ç–∞—Ö (–Ω–µ —Ä–µ—à–µ–Ω—ã):

- `tests/test_input_handler.py` - –æ—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —á–µ—Ä–µ–∑ spec
- `tests/test_xkb.py` - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞
- –ü—Ä–æ–±–ª–µ–º–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `importlib.util.spec_from_file_location` –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–º–ø–æ—Ä—Ç–∞–º–∏
- **–†–µ—à–µ–Ω–∏–µ:** –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ –ø—Ä—è–º–æ–π –∏–º–ø–æ—Ä—Ç –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mock

### ‚ö†Ô∏è Type hints –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:

- Python < 3.10: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `from __future__ import annotations` –¥–ª—è `str | None` —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
- –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –≤—Å–µ —Ñ–∞–π–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `from __future__ import annotations` ‚úÖ

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –ü–æ—á–µ–º—É –∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è?

**–ë—ã–ª–æ:**
- `config.py` - –ø—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ `load_config()`, `validate_config()`
- `managers/config_manager.py` - –∫–ª–∞—Å—Å `ConfigManager`
- –†–∞–∑–Ω—ã–µ DEFAULT_CONFIG –∑–Ω–∞—á–µ–Ω–∏—è
- –ü—É—Ç–∞–Ω–∏—Ü–∞ –∫–∞–∫–æ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**–°—Ç–∞–ª–æ:**
- –û–±–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤ `config.py`
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π: `load_config()`, `validate_config()`
- –û–±—ä–µ–∫—Ç–Ω—ã–π: –∫–ª–∞—Å—Å `ConfigManager`
- –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ú–µ–Ω—å—à–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ re-export
- –ß–µ—Ç–∫–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è: —Ñ—É–Ω–∫—Ü–∏–∏ ‚Üí –∫–ª–∞—Å—Å

### –ü–æ—á–µ–º—É —É–¥–∞–ª–µ–Ω lswitch.py?

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –í—Ä–µ–º–µ–Ω–Ω—ã–π —à–∏–º –∏–∑ –ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
- –ú–∞–Ω–∏–ø—É–ª–∏—Ä—É–µ—Ç `__path__` –¥–ª—è –ø–µ—Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–∏–º–≤–æ–ª–æ–≤
- –°–æ–∑–¥–∞–µ—Ç "–º–∞–≥–∏—é" –≤ –∏–º–ø–æ—Ä—Ç–∞—Ö
- –ó–∞–º–µ–¥–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –º–æ–¥—É–ª—è
- –£—Å–ª–æ–∂–Ω—è–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–¥–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –Ω–∞ –ø—Ä—è–º—ã–µ: `from lswitch.core import X`
- –û–±–Ω–æ–≤–∏—Ç—å entry points –≤ setup.py
- –¢–µ—Å—Ç—ã: –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª–µ–Ω—ã

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

```bash
# Type checking
python3 -m mypy lswitch/ --strict

# Type stubs generation
python3 -m pydoc-markdown

# Black formatting
black lswitch/

# Isort –¥–ª—è –∏–º–ø–æ—Ä—Ç–æ–≤
isort lswitch/

# Lint
pylint lswitch/

# Pre-commit (—Ä–µ–∫–æ–º–µ–Ω–¥—É–∫—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å)
pre-commit install
```

### VS Code –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```json
{
  "python.linting.enabled": true,
  "python.linting.pylintEnabled": true,
  "python.linting.mypyEnabled": true,
  "python.linting.mypyArgs": [
    "--ignore-missing-imports",
    "--disallow-untyped-defs"
  ]
}
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤:

```bash
# –í—Å–µ —Ä–∞–±–æ—á–∏–µ —Ç–µ—Å—Ç—ã
python3 -m pytest tests/test_config*.py tests/test_backspace*.py -v

# –¢–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä—ã–µ
python3 -m pytest tests/test_config_loader.py -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
python3 -m pytest tests/ --cov=lswitch --cov-report=html
```

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ —Ç–µ—Å—Ç—ã:
- `test_config_loader.py` ‚úÖ
- `test_config_overlay.py` ‚úÖ  
- `test_backspace_hold_retention.py` ‚úÖ
- `test_convert_and_retype.py` ‚úÖ (1 expected failure)
- `test_core_system_di.py` ‚úÖ

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:**
   - –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å type hints –≤ core.py
   - –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–æ–≤ –≤ —Ç–µ—Å—Ç–∞—Ö

2. **–ù–∞ –Ω–µ–¥–µ–ª—é:**
   - R–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–µ—Å—Ç–æ–≤
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

3. **–ù–∞ –º–µ—Å—è—Ü:**
   - 100% type coverage –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI pipeline —Å type checking
   - –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫ Wayland –ø–æ–¥–¥–µ—Ä–∂–∫–µ
